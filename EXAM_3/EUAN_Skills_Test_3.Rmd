---
title: "EUAN_Skills_Test_3.Rmd"
author: "Mariana_euan"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```


```{r}
# Load libraries
library(tidyverse)
library(ggplot2)

# Load the data
FacultySalaries_1995 <- read.csv("FacultySalaries_1995.csv")

# Check the structure of the data
str(FacultySalaries_1995)

# If necessary, convert variables to the correct data types. 
# For example, if 'State' is not a factor, you might do:
FacultySalaries_1995$State <- as.factor(FacultySalaries_1995$State)

# Similarly for 'Tier':
FacultySalaries_1995$Tier <- as.factor(FacultySalaries_1995$Tier)

# Reshape the data from wide to long format
long_data <- FacultySalaries_1995 %>%
  pivot_longer(cols = c(AvgFullProfSalary, AvgAssocProfSalary, AvgAssistProfSalary),
               names_to = "Rank",
               values_to = "Salary") %>%
  mutate(Rank = str_replace(Rank, "Avg", ""),
         Rank = str_replace(Rank, "Salary", ""),
         Rank = paste(Rank, Tier, sep = " "))

# Create the scatter plot with box plots
ggplot(long_data, aes(x = Rank, y = Salary, fill = Rank)) +
  geom_boxplot() +
  labs(x = "Rank and Tier", y = "Salary", fill = "Rank") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

# Build an ANOVA model and display the summary output in your report.
# Load necessary library
library(tidyverse)

# View the column names
colnames(FacultySalaries_1995)

# Reshape the data
reshaped_data <- FacultySalaries_1995 %>%
  gather(key = "Rank", value = "Salary", AvgFullProfSalary, AvgAssocProfSalary, AvgAssistProfSalary)

# View the first few rows of the reshaped data
head(reshaped_data)

# Build the ANOVA model
model <- aov(Salary ~ State + Tier + Rank, data = reshaped_data)

# Display the summary output
summary(model)


### QUESTION 3 OF JUNIPER_OILS
# Load necessary library
library(tidyverse)

# Loading the data
Juniper_Oils <- read_csv("Juniper_Oils.csv")

# Print column names
print(colnames(Juniper_Oils))

# View the first few rows of the data
head(Juniper_Oils)

# Check for missing values
sum(is.na(Juniper_Oils))

# If there are missing values, remove rows with missing values
Juniper_Oils <- na.omit(Juniper_Oils)

# Check the structure of the data
str(Juniper_Oils)

# Define the list of chemical compounds
compounds <- c("alpha-pinene","para-cymene","alpha-terpineol","cedr-9-ene","alpha-cedrene","beta-cedrene","cis-thujopsene","alpha-himachalene","beta-chamigrene","cuparene","compound 1","alpha-chamigrene","widdrol","cedrol","beta-acorenol","alpha-acorenol","gamma-eudesmol","beta-eudesmol","alpha-eudesmol","cedr-8-en-13-ol","cedr-8-en-15-ol","compound 2","thujopsenal")

# Reshape the data
tidy_data <- Juniper_Oils %>%
  pivot_longer(cols = all_of(compounds),
               names_to = "Compound",
               values_to = "Concentration")

# View the first few rows of the tidy data
head(tidy_data)


#QUESTION 4  Make me a graph of the following: don't change this part eveything reads well 
# Load necessary library
library(ggplot2)

# Create the graph
ggplot(tidy_data, aes(x = YearsSinceBurn, y = Concentration)) +
  geom_line(color = "blue") +
  geom_ribbon(aes(ymin = Concentration - sd(Concentration), ymax = Concentration + sd(Concentration)), alpha = 0.2) +
  facet_wrap(~ Compound, scales = "free_y") +
  theme_minimal() +
  labs(x = "Years Since Burn", y = "Concentration")

# PART 5 
# Load necessary libraries
library(tidyverse)
library(broom)

# Create the generalized linear model
model <- glm(Concentration ~ Compound + YearsSinceBurn, data = tidy_data)

# Get the model output
model_output <- tidy(model)

# Filter for significant chemicals (p < 0.05)
significant_chemicals <- model_output %>%
  filter(p.value < 0.05)

# View the significant chemicals and their model output
print(significant_chemicals)


